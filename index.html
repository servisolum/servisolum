<!doctype html>
<html lang="es">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Registro de Fiesta - Firebase</title>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .container {
      width: 90%;
      max-width: 500px;
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      padding: 40px;
      margin: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
    }

    .header h1 {
      color: #667eea;
      font-size: 32px;
      margin: 0 0 10px 0;
    }

    .header p {
      color: #666;
      font-size: 16px;
      margin: 0;
    }

    .connection-status {
      background: #e8f5e8;
      border: 1px solid #4caf50;
      padding: 10px;
      border-radius: 8px;
      margin-bottom: 20px;
      text-align: center;
      font-size: 14px;
      color: #2e7d32;
    }

    .connection-status.offline {
      background: #fff3cd;
      border-color: #ffc107;
      color: #856404;
    }

    .connection-status.error {
      background: #f8d7da;
      border-color: #dc3545;
      color: #721c24;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      color: #333;
      font-weight: 600;
      margin-bottom: 8px;
      font-size: 14px;
    }

    .form-group input {
      width: 100%;
      padding: 12px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 16px;
      transition: border-color 0.3s;
      box-sizing: border-box;
    }

    .form-group input:focus {
      outline: none;
      border-color: #667eea;
    }

    .btn-register {
      width: 100%;
      padding: 15px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .btn-register:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
    }

    .btn-register:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
    }

    .stats {
      margin-top: 30px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 10px;
      text-align: center;
    }

    .stats h3 {
      color: #667eea;
      font-size: 20px;
      margin: 0 0 15px 0;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
    }

    .stat-card {
      background: white;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .stat-number {
      font-size: 32px;
      font-weight: bold;
      color: #667eea;
      margin: 0;
    }

    .stat-label {
      font-size: 14px;
      color: #666;
      margin: 5px 0 0 0;
    }

    .guest-list {
      margin-top: 30px;
    }

    .guest-list h3 {
      color: #667eea;
      font-size: 20px;
      margin: 0 0 15px 0;
    }

    .guest-item {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .guest-info {
      flex: 1;
    }

    .guest-name {
      font-weight: 600;
      color: #333;
      font-size: 16px;
      margin: 0 0 5px 0;
    }

    .guest-time {
      font-size: 12px;
      color: #999;
      margin: 0;
    }

    .success-message {
      background: #4caf50;
      color: white;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      text-align: center;
      display: none;
    }

    .success-message.show {
      display: block;
      animation: slideDown 0.3s ease;
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .error-message {
      background: #f44336;
      color: white;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      text-align: center;
      display: none;
    }

    .error-message.show {
      display: block;
      animation: slideDown 0.3s ease;
    }

    .no-guests {
      text-align: center;
      color: #999;
      font-style: italic;
      padding: 20px;
    }

    .delete-btn {
      background: #f44336;
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 12px;
      transition: background 0.3s;
    }

    .delete-btn:hover {
      background: #d32f2f;
    }

    .export-section {
      margin-top: 20px;
      text-align: center;
    }

    .btn-export {
      background: #4caf50;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      margin: 0 5px;
      transition: background 0.3s;
    }

    .btn-export:hover {
      background: #45a049;
    }

    .config-section {
      background: #f8f9fa;
      border: 2px dashed #667eea;
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 30px;
      display: none;
    }

    .config-section.show {
      display: block;
    }

    .config-section h3 {
      color: #667eea;
      font-size: 18px;
      margin: 0 0 15px 0;
    }

    .btn-config {
      background: #667eea;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      margin: 5px;
      transition: background 0.3s;
    }

    .btn-config:hover {
      background: #5568d3;
    }

    .firebase-config {
      background: #fff3cd;
      border: 1px solid #ffeaa7;
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
    }

    .firebase-config textarea {
      width: 100%;
      height: 120px;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-family: monospace;
      font-size: 12px;
      box-sizing: border-box;
    }

    .github-info {
      background: #e3f2fd;
      border: 1px solid #2196f3;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      font-size: 14px;
    }

    .github-info h4 {
      color: #1976d2;
      margin: 0 0 10px 0;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="container">
   <div class="header">
    <h1>üéâ Registro de Fiesta</h1>
    <p>¬°Bienvenido a nuestra fiesta!</p>
   </div>
   <div id="connection-status" class="connection-status">
    üîÑ Conectando con Firebase...
   </div>
   <div id="config-section" class="config-section">
    <h3>üî• Configuraci√≥n Firebase</h3>
    <div class="github-info">
     <h4>üìã Instrucciones para GitHub Pages:</h4>
     <ol style="margin: 10px 0; padding-left: 20px;">
      <li>Sube este archivo como <code>index.html</code> a tu repositorio</li>
      <li>Activa GitHub Pages en Settings ‚Üí Pages</li>
      <li>Configura Firebase abajo y ¬°listo!</li>
     </ol>
    </div>
    <div class="firebase-config"><label for="firebase-config">Configuraci√≥n Firebase:</label>
     <p style="font-size: 12px; color: #666; margin: 5px 0;">1. Ve a <a href="https://console.firebase.google.com" target="_blank">Firebase Console</a><br>
       2. Crea/selecciona tu proyecto<br>
       3. Activa Firestore Database<br>
       4. Copia la configuraci√≥n web aqu√≠:</p><textarea id="firebase-config" placeholder="Pega aqu√≠ tu configuraci√≥n de Firebase:

{
  &quot;apiKey&quot;: &quot;AIzaSyC...&quot;,
  &quot;authDomain&quot;: &quot;tu-proyecto.firebaseapp.com&quot;,
  &quot;projectId&quot;: &quot;tu-proyecto-id&quot;,
  &quot;storageBucket&quot;: &quot;tu-proyecto.appspot.com&quot;,
  &quot;messagingSenderId&quot;: &quot;123456789&quot;,
  &quot;appId&quot;: &quot;1:123456789:web:abc123&quot;
}"></textarea>
    </div><button class="btn-config" onclick="saveFirebaseConfig()">üî• Conectar Firebase</button> <button class="btn-config" onclick="testConnection()">üß™ Probar Conexi√≥n</button> <button class="btn-config" onclick="useOfflineMode()">üì± Modo Offline</button>
   </div>
   <div id="success-message" class="success-message">
    ‚úì ¬°Registro exitoso!
   </div>
   <div id="error-message" class="error-message">
    ‚úó Error al registrar. Intenta nuevamente.
   </div>
   <form id="registration-form">
    <div class="form-group"><label for="name">Nombre Completo</label> <input type="text" id="name" required placeholder="Juan P√©rez">
    </div>
    <div class="form-group"><label for="phone">Tel√©fono</label> <input type="tel" id="phone" placeholder="+57 300 123 4567">
    </div>
    <div class="form-group"><label for="guests">N√∫mero de Acompa√±antes</label> <input type="number" id="guests" min="0" value="0">
    </div><button type="submit" class="btn-register" id="submit-btn"> Registrar Entrada </button>
   </form>
   <div class="stats">
    <h3>üìä Estad√≠sticas en Tiempo Real</h3>
    <div class="stats-grid">
     <div class="stat-card">
      <p class="stat-number" id="total-guests">0</p>
      <p class="stat-label">Total Invitados</p>
     </div>
     <div class="stat-card">
      <p class="stat-number" id="total-companions">0</p>
      <p class="stat-label">Acompa√±antes</p>
     </div>
    </div>
   </div>
   <div class="export-section"><button class="btn-export" onclick="exportToCSV()">üìä Exportar CSV</button> <button class="btn-export" onclick="exportToJSON()">üíæ Respaldar JSON</button> <button class="btn-export" onclick="clearAllData()">üóëÔ∏è Limpiar Todo</button> <button class="btn-export" onclick="showConfig()">‚öôÔ∏è Configurar</button>
   </div>
   <div class="guest-list">
    <h3>üë• Lista de Registros (√öltimos 10)</h3>
    <div id="guest-list-container">
     <div class="no-guests">
      No hay registros a√∫n
     </div>
    </div>
   </div>
  </div><!-- Firebase SDK -->
  <script type="module">
    // Importar Firebase
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
    import { 
      getFirestore, 
      collection, 
      addDoc, 
      getDocs, 
      deleteDoc, 
      doc, 
      query, 
      orderBy, 
      onSnapshot,
      serverTimestamp 
    } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

    // Variables globales
    let currentGuests = [];
    let isFirebaseConnected = false;
    let db = null;
    let app = null;
    let unsubscribe = null;

    // Configuraci√≥n por defecto (puedes cambiar estos valores)
    const DEFAULT_CONFIG = {
      apiKey: "AIzaSyBdVl-cO_MQeXVWBINTd4sJaT-2mhSmsNI",
      authDomain: "registro-fiesta-demo.firebaseapp.com",
      projectId: "registro-fiesta-demo",
      storageBucket: "registro-fiesta-demo.appspot.com",
      messagingSenderId: "987654321012",
      appId: "1:987654321012:web:abc123def456789ghi"
    };

    // Funci√≥n para actualizar estado de conexi√≥n
    function updateConnectionStatus(status, message, isError = false) {
      const statusEl = document.getElementById('connection-status');
      statusEl.textContent = message;
      statusEl.className = `connection-status ${status}`;
    }

    // Inicializar Firebase
    async function initFirebase(config = null) {
      try {
        updateConnectionStatus('connecting', 'üîÑ Conectando con Firebase...');
        
        const firebaseConfig = config || JSON.parse(localStorage.getItem('firebaseConfig')) || DEFAULT_CONFIG;
        
        // Inicializar Firebase
        app = initializeApp(firebaseConfig);
        db = getFirestore(app);
        
        // Probar conexi√≥n escribiendo y leyendo
        await testFirebaseConnection();
        
        // Configurar listener en tiempo real
        const q = query(collection(db, 'guests'), orderBy('timestamp', 'desc'));
        unsubscribe = onSnapshot(q, (snapshot) => {
          currentGuests = snapshot.docs.map(doc => ({
            id: doc.id,
            ...doc.data()
          }));
          updateUI();
        }, (error) => {
          console.error('Error en listener:', error);
          updateConnectionStatus('error', '‚ùå Error de sincronizaci√≥n - Usando datos locales');
          loadLocalData();
        });

        isFirebaseConnected = true;
        updateConnectionStatus('online', 'üî• Conectado a Firebase - Sincronizaci√≥n activa');
        
        // Guardar configuraci√≥n
        if (config) {
          localStorage.setItem('firebaseConfig', JSON.stringify(firebaseConfig));
          localStorage.setItem('appConfigured', 'true');
        }
        
        return true;
      } catch (error) {
        console.error('Error conectando Firebase:', error);
        updateConnectionStatus('error', '‚ùå Error de conexi√≥n - Usando modo offline');
        loadLocalData();
        return false;
      }
    }

    // Probar conexi√≥n Firebase
    async function testFirebaseConnection() {
      const testDoc = {
        test: true,
        timestamp: serverTimestamp()
      };
      
      // Intentar escribir un documento de prueba
      const docRef = await addDoc(collection(db, 'connection_test'), testDoc);
      
      // Intentar leerlo
      await getDocs(collection(db, 'connection_test'));
      
      // Eliminar documento de prueba
      await deleteDoc(doc(db, 'connection_test', docRef.id));
    }

    // Cargar datos locales
    function loadLocalData() {
      currentGuests = JSON.parse(localStorage.getItem('partyGuests') || '[]');
      updateUI();
    }

    // Guardar datos locales
    function saveLocalData() {
      localStorage.setItem('partyGuests', JSON.stringify(currentGuests));
    }

    // Registrar invitado
    async function registerGuest() {
      const submitBtn = document.getElementById('submit-btn');
      submitBtn.disabled = true;
      submitBtn.textContent = 'Registrando...';

      try {
        const now = new Date();
        const guestData = {
          name: document.getElementById('name').value.trim(),
          phone: document.getElementById('phone').value.trim(),
          companions: parseInt(document.getElementById('guests').value) || 0,
          timestamp: serverTimestamp(),
          entryTime: now.toLocaleString('es-ES'),
          registrationNumber: currentGuests.length + 1
        };

        if (isFirebaseConnected && db) {
          // Guardar en Firebase
          await addDoc(collection(db, 'guests'), guestData);
          showSuccess('‚úÖ ¬°Registro guardado en Firebase!');
        } else {
          // Guardar localmente
          guestData.id = Date.now().toString();
          guestData.timestamp = now.toISOString();
          currentGuests.unshift(guestData);
          saveLocalData();
          updateUI();
          showSuccess('‚úÖ ¬°Registro guardado localmente!');
        }

        document.getElementById('registration-form').reset();
      } catch (error) {
        console.error('Error registering guest:', error);
        showError('‚ùå Error al registrar. Intenta nuevamente.');
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = 'Registrar Entrada';
      }
    }

    // Eliminar invitado
    async function deleteGuest(guestId) {
      try {
        if (isFirebaseConnected && db) {
          await deleteDoc(doc(db, 'guests', guestId));
          showSuccess('üóëÔ∏è Registro eliminado de Firebase');
        } else {
          currentGuests = currentGuests.filter(guest => guest.id !== guestId);
          saveLocalData();
          updateUI();
          showSuccess('üóëÔ∏è Registro eliminado localmente');
        }
      } catch (error) {
        console.error('Error deleting guest:', error);
        showError('‚ùå Error al eliminar registro');
      }
    }

    // Actualizar interfaz
    function updateUI() {
      const totalGuests = currentGuests.length;
      const totalCompanions = currentGuests.reduce((sum, guest) => sum + (guest.companions || 0), 0);
      
      document.getElementById('total-guests').textContent = totalGuests;
      document.getElementById('total-companions').textContent = totalCompanions;

      const container = document.getElementById('guest-list-container');
      
      if (currentGuests.length === 0) {
        container.innerHTML = '<div class="no-guests">No hay registros a√∫n</div>';
        return;
      }

      container.innerHTML = '';
      
      // Mostrar √∫ltimos 10 registros
      const recentGuests = currentGuests.slice(0, 10);

      recentGuests.forEach((guest) => {
        const guestItem = document.createElement('div');
        guestItem.className = 'guest-item';
        
        guestItem.innerHTML = `
          <div class="guest-info">
            <p class="guest-name">${guest.name}</p>
            <p class="guest-time">${guest.entryTime} ‚Ä¢ ${guest.companions || 0} acompa√±antes</p>
          </div>
          <button class="delete-btn" onclick="window.deleteGuest('${guest.id}')">Eliminar</button>
        `;
        
        container.appendChild(guestItem);
      });
    }

    // Funciones de mensajes
    function showSuccess(message) {
      const successMsg = document.getElementById('success-message');
      successMsg.textContent = message;
      successMsg.classList.add('show');
      setTimeout(() => successMsg.classList.remove('show'), 3000);
    }

    function showError(message) {
      const errorMsg = document.getElementById('error-message');
      errorMsg.textContent = message;
      errorMsg.classList.add('show');
      setTimeout(() => errorMsg.classList.remove('show'), 3000);
    }

    // Guardar configuraci√≥n Firebase
    async function saveFirebaseConfig() {
      const configText = document.getElementById('firebase-config').value.trim();
      if (!configText) {
        showError('Por favor ingresa la configuraci√≥n de Firebase');
        return;
      }

      try {
        let config;
        
        // Extraer JSON de diferentes formatos
        if (configText.includes('const firebaseConfig')) {
          const match = configText.match(/const\s+firebaseConfig\s*=\s*({[\s\S]*?});?/);
          if (match) {
            config = JSON.parse(match[1]);
          }
        } else if (configText.startsWith('{')) {
          config = JSON.parse(configText);
        } else {
          const jsonMatch = configText.match(/{[\s\S]*}/);
          if (jsonMatch) {
            config = JSON.parse(jsonMatch[0]);
          }
        }

        if (!config || !config.apiKey || !config.projectId) {
          throw new Error('Configuraci√≥n incompleta');
        }

        showSuccess('‚è≥ Conectando con Firebase...');
        document.getElementById('config-section').classList.remove('show');
        
        const success = await initFirebase(config);
        if (success) {
          showSuccess('üî• ¬°Conectado exitosamente a Firebase!');
        }
      } catch (error) {
        showError(`‚ùå Error: ${error.message}`);
      }
    }

    // Probar conexi√≥n
    async function testConnection() {
      if (!isFirebaseConnected) {
        showError('‚ùå No hay conexi√≥n activa con Firebase');
        return;
      }

      try {
        updateConnectionStatus('connecting', 'üß™ Probando conexi√≥n...');
        await testFirebaseConnection();
        updateConnectionStatus('online', '‚úÖ Conexi√≥n exitosa - Firebase funcionando');
        showSuccess('üß™ ¬°Conexi√≥n probada exitosamente!');
      } catch (error) {
        updateConnectionStatus('error', '‚ùå Error en prueba de conexi√≥n');
        showError('‚ùå Error al probar conexi√≥n');
      }
    }

    // Modo offline
    function useOfflineMode() {
      localStorage.setItem('appConfigured', 'true');
      document.getElementById('config-section').classList.remove('show');
      updateConnectionStatus('offline', 'üì± Modo offline - Datos guardados localmente');
      loadLocalData();
      showSuccess('üì± Configurado en modo offline');
    }

    // Exportar a CSV
    function exportToCSV() {
      if (currentGuests.length === 0) {
        showError('No hay datos para exportar');
        return;
      }

      const headers = ['Nombre', 'Tel√©fono', 'Acompa√±antes', 'Fecha y Hora'];
      const csvContent = [
        headers.join(','),
        ...currentGuests.map(guest => [
          `"${guest.name}"`,
          `"${guest.phone || ''}"`,
          guest.companions || 0,
          `"${guest.entryTime}"`
        ].join(','))
      ].join('\n');

      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement('a');
      const url = URL.createObjectURL(blob);
      link.setAttribute('href', url);
      link.setAttribute('download', `registro_fiesta_${new Date().toISOString().split('T')[0]}.csv`);
      link.style.visibility = 'hidden';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      showSuccess('üìä Archivo CSV descargado');
    }

    // Exportar a JSON
    function exportToJSON() {
      if (currentGuests.length === 0) {
        showError('No hay datos para exportar');
        return;
      }

      const backup = {
        data: currentGuests,
        timestamp: new Date().toISOString(),
        totalRecords: currentGuests.length,
        source: isFirebaseConnected ? 'firebase' : 'local'
      };

      const dataStr = JSON.stringify(backup, null, 2);
      const blob = new Blob([dataStr], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `registro_fiesta_backup_${new Date().toISOString().split('T')[0]}.json`;
      link.click();
      URL.revokeObjectURL(url);
      
      showSuccess('üíæ Respaldo JSON descargado');
    }

    // Limpiar todos los datos
    async function clearAllData() {
      if (currentGuests.length === 0) {
        showError('No hay datos para eliminar');
        return;
      }

      const container = document.getElementById('guest-list-container');
      const confirmDiv = document.createElement('div');
      confirmDiv.style.cssText = 'background: #fff3cd; border: 1px solid #ffeaa7; padding: 15px; border-radius: 8px; text-align: center; margin-bottom: 15px;';
      confirmDiv.innerHTML = `
        <p style="margin: 0 0 10px 0; color: #856404;">‚ö†Ô∏è ¬øEst√°s seguro de eliminar TODOS los registros?</p>
        <button onclick="window.confirmClearAll()" style="background: #dc3545; color: white; border: none; padding: 8px 16px; border-radius: 5px; margin: 0 5px; cursor: pointer;">S√≠, eliminar todo</button>
        <button onclick="window.cancelClearAll()" style="background: #6c757d; color: white; border: none; padding: 8px 16px; border-radius: 5px; margin: 0 5px; cursor: pointer;">Cancelar</button>
      `;
      
      container.insertBefore(confirmDiv, container.firstChild);
    }

    // Confirmar limpiar todo
    async function confirmClearAll() {
      try {
        if (isFirebaseConnected && db) {
          const snapshot = await getDocs(collection(db, 'guests'));
          for (const docSnap of snapshot.docs) {
            await deleteDoc(doc(db, 'guests', docSnap.id));
          }
          showSuccess('üóëÔ∏è Todos los registros eliminados de Firebase');
        } else {
          currentGuests = [];
          saveLocalData();
          updateUI();
          showSuccess('üóëÔ∏è Todos los registros eliminados localmente');
        }
      } catch (error) {
        showError('‚ùå Error al eliminar registros');
      }
      cancelClearAll();
    }

    // Cancelar limpiar
    function cancelClearAll() {
      const confirmDiv = document.querySelector('#guest-list-container > div');
      if (confirmDiv && confirmDiv.innerHTML.includes('¬øEst√°s seguro')) {
        confirmDiv.remove();
      }
    }

    // Mostrar configuraci√≥n
    function showConfig() {
      document.getElementById('config-section').classList.add('show');
    }

    // Exponer funciones globales
    window.registerGuest = registerGuest;
    window.deleteGuest = deleteGuest;
    window.saveFirebaseConfig = saveFirebaseConfig;
    window.testConnection = testConnection;
    window.useOfflineMode = useOfflineMode;
    window.exportToCSV = exportToCSV;
    window.exportToJSON = exportToJSON;
    window.clearAllData = clearAllData;
    window.confirmClearAll = confirmClearAll;
    window.cancelClearAll = cancelClearAll;
    window.showConfig = showConfig;

    // Inicializar aplicaci√≥n
    document.addEventListener('DOMContentLoaded', async () => {
      document.getElementById('registration-form').addEventListener('submit', (e) => {
        e.preventDefault();
        registerGuest();
      });

      // Auto-inicializar si ya est√° configurado
      if (localStorage.getItem('appConfigured')) {
        await initFirebase();
      } else {
        document.getElementById('config-section').classList.add('show');
        updateConnectionStatus('offline', '‚öôÔ∏è Configuraci√≥n requerida');
      }
    });
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'999f63f126f7a4c8',t:'MTc2MjM3NzU3Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
